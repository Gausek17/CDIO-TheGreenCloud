<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AdminSection</title>
    <link rel="stylesheet" type="text/css" href="../css/estilo_userParcelasMovil.css">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>

<div class="container" id="container">
    <div id="mySidenav" class="sidenav">
        <div class="headerMenu"><span class="menuTextAdmin">User Panel</span><a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a></div>
            <a href="#" class="itemMenu"><img src="../imagenes/admin/IconoCampo-White.png" alt="imagenCampo" class="iconParcelas"><span class="menuText">Parcelas</span></a>

        
    </div>
    <header>
        <img src="imagenes/logoGTI.svg" alt="Logo GTI" class="logoGTI">
        <img onclick="openNav()" src="../imagenes/admin/iconMenu.png" alt="Menu" class="iconMenu">
        <div class="divUsuario">
            <p id="textNombreUsuario">Nombre Usuario</p>
            <img src="../imagenes/iconUser.png" alt="Icono Usuario" class="iconUseer">
        </div>
    </header>
    <div class="divCentral">
        <nav>
            <p class="textAdmin">User Panel</p>
            <ul>
                <li class="navParcela">
                       <a href="#" class="itemNav"><img src="../imagenes/admin/IconoCampo-White.png" alt="Imagen Campo" class="iconParcelas"><span class="textNav">Parcela</span></a></li>
                
            </ul>
        </nav>
        <div class="divContenido">
            <div class="divPanelActual">
                <img src="../imagenes/parcelas/IconoCampo-White.png" alt="Gestión Usuarios" class="iconGestionUsuariosSelected"> Parcelas
            </div>
            <div class="divNuevoUsuario">
                <img src="../imagenes/parcelas/icono-maps.png" alt="Añadir usuario" class="iconNuevoUsuario">
                <p><u>Seleccione la parcela</u></p>
                
                   
                   <div class="desplegable">
                    <button class="boton"><img src="../imagenes/boton.png" id="select"></button>
                    <div class="lista">
                        <a href="#">Parcela de trigo</a>
                        <a href="#">Parcela de maíz</a>
                        <a href="#"
                        >Parcela de melocotones</a>
                        <a href="#">Parcela de limones</a>
                    </div>
                </div>
                <section class="button">
                <button class="delete">Limpiar Mapa</button>
                <div class="borrado">
                    <a href="#"
                        ></a>
                </div>
                </section>
            </div>
            
            <div class="divContenidoUser">
<div id="map">

</div>

<script>
    var infoWindow;
    var map;
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 38.9965055, lng: -0.1674364},
            zoom: 15,
            mapTypeId: 'hybrid',
            styles: [
                {
                    featureType: 'poi',
                    stylers: [{visibility: 'off'}]
                },
                {
                    featureType: 'transit',
                    stylers: [{visibility: 'off'}]
                }
            ],
            mapTypeControl: false,
            streetViewControl: false,
            rotateControl: false,
        });
        map.setTilt(0);
        function cargarPosiciones() {
            fetch('data/posiciones.json').then(function (r) {
                return r.json();

            }).then(function (json) {
                json.forEach(function (posicion) {

                        var marker = new google.maps.Marker({
                            position:posicion,
                            label: posicion.id+"",
                            animation: google.maps.Animation.DROP,
                            map: map
                        });
                        marker.addListener('click', function () {
                            infoWindow.setContent("Posicion: "+ posicion.id);
                            infoWindow.open(map, marker);
                        })

                })

            })
        }


        function cargarParcelas(){
            fetch('data/parcelas.json').then(function (r) {
                    return r.json();
            }).then(function (json) {
                let bounds = new google.maps.LatLngBounds();

                json.forEach(function (pos) {
                    let polygon = new google.maps.Polygon({
                        paths: pos.vertices,
                        strokeColor: "#ff8000",
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: pos.color,
                        fillOpacity: 0.35,
                        map: map
                    });
                    polygon.getPath().getArray().forEach(function (v) {
                        bounds.extend(v);
                    });
                    polygon.addListener('click', function () {
                        infoWindow.setContent( document.getElementById("lorem"));
                        infoWindow.open(map, polygon);
                    })
                });
                map.fitBounds(bounds);
            })
        }
        infoWindow = new google.maps.InfoWindow();
        cargarParcelas();
        cargarPosiciones();
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?callback=initMap" async defer>
</script>
                

                
                </div>
            </div>
        </div>
    </div>


<script>
    /* Set the width of the side navigation to 250px and the left margin of the page content to 250px and add a black background color to body */
    function openNav() {
        document.getElementById("mySidenav").style.width = "300px";
        document.body.style.backgroundColor = "rgba(0,0,0,0.7)"
        var lista = document.getElementsByClassName("divPerson");
        for (let i = 0; i<lista.length; i++){
            lista[i].style.opacity = "0.5";
        }
        document.getElementById("panelActual").style.opacity = "0.5";
    }

    /* Set the width of the side navigation to 0 and the left margin of the page content to 0, and the background color of body to white */
    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
        document.body.style.backgroundColor = "white";
        var lista = document.getElementsByClassName("divPerson");
        for (let i = 0; i<lista.length; i++){
            lista[i].style.opacity = "1";
        }
        document.getElementById("panelActual").style.opacity = "1";
    }
</script>
</body>
</html>